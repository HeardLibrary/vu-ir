import { inject, InjectionToken } from '@angular/core';
import { requireNonNull } from '../utils/coercion';
const CONFIG_NOT_FOUND = 'No Matomo configuration found! Have you included Matomo module using MatomoModule.forRoot() or provideMatomo()?';
/** Internal marker token to detect that router has been enabled */
export const MATOMO_ROUTER_ENABLED = new InjectionToken('MATOMO_ROUTER_ENABLED', {
    factory() {
        return false;
    },
});
/** Injection token for {@link MatomoConfiguration} */
export const MATOMO_CONFIGURATION = new InjectionToken('MATOMO_CONFIGURATION');
/**
 * For internal use only. Injection token for {@link InternalMatomoConfiguration}
 *
 */
export const INTERNAL_MATOMO_CONFIGURATION = new InjectionToken('INTERNAL_MATOMO_CONFIGURATION', {
    factory() {
        const { mode, requireConsent, ...restConfig } = requireNonNull(inject(MATOMO_CONFIGURATION, { optional: true }), CONFIG_NOT_FOUND);
        return {
            mode: mode ? coerceInitializationMode(mode) : undefined,
            disabled: false,
            enableLinkTracking: true,
            trackAppInitialLoad: !inject(MATOMO_ROUTER_ENABLED),
            requireConsent: requireConsent ? coerceConsentRequirement(requireConsent) : 'none',
            enableJSErrorTracking: false,
            runOutsideAngularZone: false,
            disableCampaignParameters: false,
            acceptDoNotTrack: false,
            ...restConfig,
        };
    },
});
/**
 * For internal use only. Injection token for deferred {@link InternalMatomoConfiguration}.
 *
 */
export const DEFERRED_INTERNAL_MATOMO_CONFIGURATION = new InjectionToken('DEFERRED_INTERNAL_MATOMO_CONFIGURATION', {
    factory: () => {
        const base = inject(INTERNAL_MATOMO_CONFIGURATION);
        let resolveFn;
        const configuration = new Promise(resolve => (resolveFn = resolve));
        return {
            configuration,
            markReady(configuration) {
                requireNonNull(resolveFn, 'resolveFn')({
                    ...base,
                    ...configuration,
                });
            },
        };
    },
});
/**
 * For internal use only. Injection token for fully loaded async {@link InternalMatomoConfiguration}.
 *
 */
export const ASYNC_INTERNAL_MATOMO_CONFIGURATION = new InjectionToken('ASYNC_INTERNAL_MATOMO_CONFIGURATION', {
    factory: () => inject(DEFERRED_INTERNAL_MATOMO_CONFIGURATION).configuration,
});
/** @deprecated Use {@link MatomoInitializationBehavior} instead */
export var MatomoInitializationMode;
(function (MatomoInitializationMode) {
    /**
     * Automatically inject matomo script using provided configuration
     *
     * @deprecated Use `'auto'` instead
     */
    MatomoInitializationMode[MatomoInitializationMode["AUTO"] = 0] = "AUTO";
    /**
     * Do not inject Matomo script. In this case, initialization script must be provided
     *
     * @deprecated Use `'manual'` instead
     */
    MatomoInitializationMode[MatomoInitializationMode["MANUAL"] = 1] = "MANUAL";
    /**
     * Automatically inject matomo script when deferred tracker configuration is provided using `MatomoInitializerService.initializeTracker()`.
     *
     * @deprecated Use `'deferred'` instead
     */
    MatomoInitializationMode[MatomoInitializationMode["AUTO_DEFERRED"] = 2] = "AUTO_DEFERRED";
})(MatomoInitializationMode || (MatomoInitializationMode = {}));
export function coerceInitializationMode(value) {
    switch (value) {
        case MatomoInitializationMode.AUTO:
            return 'auto';
        case MatomoInitializationMode.MANUAL:
            return 'manual';
        case MatomoInitializationMode.AUTO_DEFERRED:
            return 'deferred';
        default:
            return value;
    }
}
/** @deprecated Use {@link MatomoConsentRequirement} instead */
export var MatomoConsentMode;
(function (MatomoConsentMode) {
    /** Do not require any consent, always track users */
    MatomoConsentMode[MatomoConsentMode["NONE"] = 0] = "NONE";
    /** Require cookie consent */
    MatomoConsentMode[MatomoConsentMode["COOKIE"] = 1] = "COOKIE";
    /** Require tracking consent */
    MatomoConsentMode[MatomoConsentMode["TRACKING"] = 2] = "TRACKING";
})(MatomoConsentMode || (MatomoConsentMode = {}));
export function coerceConsentRequirement(value) {
    switch (value) {
        case MatomoConsentMode.NONE:
            return 'none';
        case MatomoConsentMode.COOKIE:
            return 'cookie';
        case MatomoConsentMode.TRACKING:
            return 'tracking';
        default:
            return value;
    }
}
export function isAutoConfigurationMode(config) {
    return (config.mode == null || config.mode === 'auto' || config.mode === MatomoInitializationMode.AUTO);
}
function hasMainTrackerConfiguration(config) {
    // If one is undefined, both should be
    return config.siteId != null && config.trackerUrl != null;
}
export function isEmbeddedTrackerConfiguration(config) {
    return config.scriptUrl != null && !hasMainTrackerConfiguration(config);
}
export function isExplicitTrackerConfiguration(config) {
    return hasMainTrackerConfiguration(config) || isMultiTrackerConfiguration(config);
}
export function isMultiTrackerConfiguration(config) {
    return Array.isArray(config.trackers);
}
export function getTrackersConfiguration(config) {
    return isMultiTrackerConfiguration(config)
        ? config.trackers
        : [
            {
                trackerUrl: config.trackerUrl,
                siteId: config.siteId,
                trackerUrlSuffix: config.trackerUrlSuffix,
            },
        ];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlndXJhdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1tYXRvbW8tY2xpZW50L2NvcmUvdHJhY2tlci9jb25maWd1cmF0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsY0FBYyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVuRCxNQUFNLGdCQUFnQixHQUNwQixpSEFBaUgsQ0FBQztBQUVwSCxtRUFBbUU7QUFDbkUsTUFBTSxDQUFDLE1BQU0scUJBQXFCLEdBQUcsSUFBSSxjQUFjLENBQVUsdUJBQXVCLEVBQUU7SUFDeEYsT0FBTztRQUNMLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztDQUNGLENBQUMsQ0FBQztBQUVILHNEQUFzRDtBQUN0RCxNQUFNLENBQUMsTUFBTSxvQkFBb0IsR0FBRyxJQUFJLGNBQWMsQ0FBc0Isc0JBQXNCLENBQUMsQ0FBQztBQUVwRzs7O0dBR0c7QUFDSCxNQUFNLENBQUMsTUFBTSw2QkFBNkIsR0FBRyxJQUFJLGNBQWMsQ0FDN0QsK0JBQStCLEVBQy9CO0lBQ0UsT0FBTztRQUNMLE1BQU0sRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLEdBQUcsVUFBVSxFQUFFLEdBQUcsY0FBYyxDQUM1RCxNQUFNLENBQUMsb0JBQW9CLEVBQUUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFDaEQsZ0JBQWdCLENBQ2pCLENBQUM7UUFFRixPQUFPO1lBQ0wsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsd0JBQXdCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVM7WUFDdkQsUUFBUSxFQUFFLEtBQUs7WUFDZixrQkFBa0IsRUFBRSxJQUFJO1lBQ3hCLG1CQUFtQixFQUFFLENBQUMsTUFBTSxDQUFDLHFCQUFxQixDQUFD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Syx3QkFBd0IsQ0FBQyxJQUFJLENBQy9GLENBQUM7QUFDSixDQUFDO0FBRUQsU0FBUywyQkFBMkIsQ0FDbEMsTUFBa0M7SUFFbEMsc0NBQXNDO0lBQ3RDLE9BQU8sTUFBTSxDQUFDLE1BQU0sSUFBSSxJQUFJLElBQUksTUFBTSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUM7QUFDNUQsQ0FBQztBQUVELE1BQU0sVUFBVSw4QkFBOEIsQ0FDNUMsTUFBa0M7SUFFbEMsT0FBTyxNQUFNLENBQUMsU0FBUyxJQUFJLElBQUksSUFBSSxDQUFDLDJCQUEyQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzFFLENBQUM7QUFFRCxNQUFNLFVBQVUsOEJBQThCLENBQzVDLE1BQWtDO0lBRWxDLE9BQU8sMkJBQTJCLENBQUMsTUFBTSxDQUFDLElBQUksMkJBQTJCLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDcEYsQ0FBQztBQUVELE1BQU0sVUFBVSwyQkFBMkIsQ0FDekMsTUFBb0Q7SUFFcEQsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUN4QyxDQUFDO0FBRUQsTUFBTSxVQUFVLHdCQUF3QixDQUN0QyxNQUFzRDtJQUV0RCxPQUFPLDJCQUEyQixDQUFDLE1BQU0sQ0FBQztRQUN4QyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVE7UUFDakIsQ0FBQyxDQUFDO1lBQ0U7Z0JBQ0UsVUFBVSxFQUFFLE1BQU0sQ0FBQyxVQUFVO2dCQUM3QixNQUFNLEVBQUUsTUFBTSxDQUFDLE1BQU07Z0JBQ3JCLGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxnQkFBZ0I7YUFDMUM7U0FDRixDQUFDO0FBQ1IsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluamVjdCwgSW5qZWN0aW9uVG9rZW4gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IHJlcXVpcmVOb25OdWxsIH0gZnJvbSAnLi4vdXRpbHMvY29lcmNpb24nO1xuXG5jb25zdCBDT05GSUdfTk9UX0ZPVU5EID1cbiAgJ05vIE1hdG9tbyBjb25maWd1cmF0aW9uIGZvdW5kISBIYXZlIHlvdSBpbmNsdWRlZCBNYXRvbW8gbW9kdWxlIHVzaW5nIE1hdG9tb01vZHVsZS5mb3JSb290KCkgb3IgcHJvdmlkZU1hdG9tbygpPyc7XG5cbi8qKiBJbnRlcm5hbCBtYXJrZXIgdG9rZW4gdG8gZGV0ZWN0IHRoYXQgcm91dGVyIGhhcyBiZWVuIGVuYWJsZWQgKi9cbmV4cG9ydCBjb25zdCBNQVRPTU9fUk9VVEVSX0VOQUJMRUQgPSBuZXcgSW5qZWN0aW9uVG9rZW48Ym9vbGVhbj4oJ01BVE9NT19ST1VURVJfRU5BQkxFRCcsIHtcbiAgZmFjdG9yeSgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG59KTtcblxuLyoqIEluamVjdGlvbiB0b2tlbiBmb3Ige0BsaW5rIE1hdG9tb0NvbmZpZ3VyYXRpb259ICovXG5leHBvcnQgY29uc3QgTUFUT01PX0NPTkZJR1VSQVRJT04gPSBuZXcgSW5qZWN0aW9uVG9rZW48TWF0b21vQ29uZmlndXJhdGlvbj4oJ01BVE9NT19DT05GSUdVUkFUSU9OJyk7XG5cbi8qKlxuICogRm9yIGludGVybmFsIHVzZSBvbmx5LiBJbmplY3Rpb24gdG9rZW4gZm9yIHtAbGluayBJbnRlcm5hbE1hdG9tb0NvbmZpZ3VyYXRpb259XG4gKlxuICovXG5leHBvcnQgY29uc3QgSU5URVJOQUxfTUFUT01PX0NPTkZJR1VSQVRJT04gPSBuZXcgSW5qZWN0aW9uVG9rZW48SW50ZXJuYWxNYXRvbW9Db25maWd1cmF0aW9uPihcbiAgJ0lOVEVSTkFMX01BVE9NT19DT05GSUdVUkFUSU9OJyxcbiAge1xuICAgIGZhY3RvcnkoKTogSW50ZXJuYWxNYXRvbW9Db25maWd1cmF0aW9uIHtcbiAgICAgIGNvbnN0IHsgbW9kZSwgcmVxdWlyZUNvbnNlbnQsIC4uLnJlc3RDb25maWcgfSA9IHJlcXVpcmVOb25OdWxsKFxuICAgICAgICBpbmplY3QoTUFUT01PX0NPTkZJR1VSQVRJT04sIHsgb3B0aW9uYWw6IHRydWUgfSksXG4gICAgICAgIENPTkZJR19OT1RfRk9VTkQsXG4gICAgICApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBtb2RlOiBtb2RlID8gY29lcmNlSW5pdGlhbGl6YXRpb25Nb2RlKG1vZGUpIDogdW5kZWZpbmVkLFxuICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICAgIGVuYWJsZUxpbmtUcmFja2luZzogdHJ1ZSxcbiAgICAgICAgdHJhY2tBcHBJbml0aWFsTG9hZDogIWluamVjdChNQVRPTU9fUk9VVEVSX0VOQUJMRUQpLFxuICAgICAgICByZXF1aXJlQ29uc2VudDogcmVxdWlyZUNvbnNlbnQgPyBjb2VyY2VDb25zZW50UmVxdWlyZW1lbnQocmVxdWlyZUNvbnNlbnQpIDogJ25vbmUnLFxuICAgICAgICBlbmFibGVKU0Vycm9yVHJhY2tpbmc6IGZhbHNlLFxuICAgICAgICBydW5PdXRzaWRlQW5ndWxhclpvbmU6IGZhbHNlLFxuICAgICAgICBkaXNhYmxlQ2FtcGFpZ25QYXJhbWV0ZXJzOiBmYWxzZSxcbiAgICAgICAgYWNjZXB0RG9Ob3RUcmFjazogZmFsc2UsXG4gICAgICAgIC4uLnJlc3RDb25maWcsXG4gICAgICB9O1xuICAgIH0sXG4gIH0sXG4pO1xuXG4vKipcbiAqIEZvciBpbnRlcm5hbCB1c2Ugb25seS4gSW5qZWN0aW9uIHRva2VuIGZvciBkZWZlcnJlZCB7QGxpbmsgSW50ZXJuYWxNYXRvbW9Db25maWd1cmF0aW9ufS5cbiAqXG4gKi9cbmV4cG9ydCBjb25zdCBERUZFUlJFRF9JTlRFUk5BTF9NQVRPTU9fQ09ORklHVVJBVElPTiA9XG4gIG5ldyBJbmplY3Rpb25Ub2tlbjxEZWZlcnJlZEludGVybmFsTWF0b21vQ29uZmlndXJhdGlvbj4oXG4gICAgJ0RFRkVSUkVEX0lOVEVSTkFMX01BVE9NT19DT05GSUdVUkFUSU9OJyxcbiAgICB7XG4gICAgICBmYWN0b3J5OiAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGJhc2UgPSBpbmplY3QoSU5URVJOQUxfTUFUT01PX0NPTkZJR1VSQVRJT04pO1xuICAgICAgICBsZXQgcmVzb2x2ZUZuOiAoKGNvbmZpZ3VyYXRpb246IEludGVybmFsTWF0b21vQ29uZmlndXJhdGlvbikgPT4gdm9pZCkgfCB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IGNvbmZpZ3VyYXRpb24gPSBuZXcgUHJvbWlzZTxJbnRlcm5hbE1hdG9tb0NvbmZpZ3VyYXRpb24+KFxuICAgICAgICAgIHJlc29sdmUgPT4gKHJlc29sdmVGbiA9IHJlc29sdmUpLFxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29uZmlndXJhdGlvbixcbiAgICAgICAgICBtYXJrUmVhZHkoY29uZmlndXJhdGlvbikge1xuICAgICAgICAgICAgcmVxdWlyZU5vbk51bGwoXG4gICAgICAgICAgICAgIHJlc29sdmVGbixcbiAgICAgICAgICAgICAgJ3Jlc29sdmVGbicsXG4gICAgICAgICAgICApKHtcbiAgICAgICAgICAgICAgLi4uYmFzZSxcbiAgICAgICAgICAgICAgLi4uY29uZmlndXJhdGlvbixcbiAgICAgICAgICAgIH0gYXMgSW50ZXJuYWxNYXRvbW9Db25maWd1cmF0aW9uKTtcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9LFxuICApO1xuXG4vKipcbiAqIEZvciBpbnRlcm5hbCB1c2Ugb25seS4gSW5qZWN0aW9uIHRva2VuIGZvciBmdWxseSBsb2FkZWQgYXN5bmMge0BsaW5rIEludGVybmFsTWF0b21vQ29uZmlndXJhdGlvbn0uXG4gKlxuICovXG5leHBvcnQgY29uc3QgQVNZTkNfSU5URVJOQUxfTUFUT01PX0NPTkZJR1VSQVRJT04gPSBuZXcgSW5qZWN0aW9uVG9rZW48XG4gIFByb21pc2U8SW50ZXJuYWxNYXRvbW9Db25maWd1cmF0aW9uPlxuPignQVNZTkNfSU5URVJOQUxfTUFUT01PX0NPTkZJR1VSQVRJT04nLCB7XG4gIGZhY3Rvcnk6ICgpID0+IGluamVjdChERUZFUlJFRF9JTlRFUk5BTF9NQVRPTU9fQ09ORklHVVJBVElPTikuY29uZmlndXJhdGlvbixcbn0pO1xuXG4vKipcbiAqIEZvciBpbnRlcm5hbCB1c2Ugb25seS4gTW9kdWxlIGNvbmZpZ3VyYXRpb24gbWVyZ2VkIHdpdGggZGVmYXVsdCB2YWx1ZXMuXG4gKlxuICovXG5leHBvcnQgdHlwZSBJbnRlcm5hbE1hdG9tb0NvbmZpZ3VyYXRpb24gPSBPbWl0PE1hdG9tb0NvbmZpZ3VyYXRpb24sICdtb2RlJyB8ICdyZXF1aXJlQ29uc2VudCc+ICZcbiAgT21pdDxSZXF1aXJlZDxCYXNlTWF0b21vQ29uZmlndXJhdGlvbj4sICdyZXF1aXJlQ29uc2VudCc+ICYge1xuICAgIG1vZGU/OiBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9yO1xuICAgIHJlcXVpcmVDb25zZW50OiBNYXRvbW9Db25zZW50UmVxdWlyZW1lbnQ7XG4gIH07XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVmZXJyZWRJbnRlcm5hbE1hdG9tb0NvbmZpZ3VyYXRpb24ge1xuICByZWFkb25seSBjb25maWd1cmF0aW9uOiBQcm9taXNlPEludGVybmFsTWF0b21vQ29uZmlndXJhdGlvbj47XG5cbiAgbWFya1JlYWR5KGNvbmZpZ3VyYXRpb246IEF1dG9NYXRvbW9Db25maWd1cmF0aW9uPCdhdXRvJyB8ICdkZWZlcnJlZCc+KTogdm9pZDtcbn1cblxuLyoqXG4gKiAtIF9fYXV0b19fOiBhdXRvbWF0aWNhbGx5IGluamVjdCBtYXRvbW8gc2NyaXB0IHVzaW5nIHByb3ZpZGVkIGNvbmZpZ3VyYXRpb25cbiAqIC0gX19tYW51YWxfXzogZG8gbm90IGluamVjdCBNYXRvbW8gc2NyaXB0LiBJbiB0aGlzIGNhc2UsIGluaXRpYWxpemF0aW9uIHNjcmlwdCBtdXN0IGJlIHByb3ZpZGVkXG4gKiAtIF9fZGVmZXJyZWRfXzogYXV0b21hdGljYWxseSBpbmplY3QgbWF0b21vIHNjcmlwdCB3aGVuIGRlZmVycmVkIHRyYWNrZXIgY29uZmlndXJhdGlvbiBpcyBwcm92aWRlZCB1c2luZyBgTWF0b21vSW5pdGlhbGl6ZXJTZXJ2aWNlLmluaXRpYWxpemVUcmFja2VyKClgLlxuICovXG5leHBvcnQgdHlwZSBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9yID0gJ2F1dG8nIHwgJ21hbnVhbCcgfCAnZGVmZXJyZWQnO1xuXG4vKiogQGRlcHJlY2F0ZWQgVXNlIHtAbGluayBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9yfSBpbnN0ZWFkICovXG5leHBvcnQgZW51bSBNYXRvbW9Jbml0aWFsaXphdGlvbk1vZGUge1xuICAvKipcbiAgICogQXV0b21hdGljYWxseSBpbmplY3QgbWF0b21vIHNjcmlwdCB1c2luZyBwcm92aWRlZCBjb25maWd1cmF0aW9uXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIFVzZSBgJ2F1dG8nYCBpbnN0ZWFkXG4gICAqL1xuICBBVVRPLFxuICAvKipcbiAgICogRG8gbm90IGluamVjdCBNYXRvbW8gc2NyaXB0LiBJbiB0aGlzIGNhc2UsIGluaXRpYWxpemF0aW9uIHNjcmlwdCBtdXN0IGJlIHByb3ZpZGVkXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIFVzZSBgJ21hbnVhbCdgIGluc3RlYWRcbiAgICovXG4gIE1BTlVBTCxcbiAgLyoqXG4gICAqIEF1dG9tYXRpY2FsbHkgaW5qZWN0IG1hdG9tbyBzY3JpcHQgd2hlbiBkZWZlcnJlZCB0cmFja2VyIGNvbmZpZ3VyYXRpb24gaXMgcHJvdmlkZWQgdXNpbmcgYE1hdG9tb0luaXRpYWxpemVyU2VydmljZS5pbml0aWFsaXplVHJhY2tlcigpYC5cbiAgICpcbiAgICogQGRlcHJlY2F0ZWQgVXNlIGAnZGVmZXJyZWQnYCBpbnN0ZWFkXG4gICAqL1xuICBBVVRPX0RFRkVSUkVELFxufVxuXG5leHBvcnQgZnVuY3Rpb24gY29lcmNlSW5pdGlhbGl6YXRpb25Nb2RlKFxuICB2YWx1ZTogTWF0b21vSW5pdGlhbGl6YXRpb25CZWhhdmlvcklucHV0LFxuKTogTWF0b21vSW5pdGlhbGl6YXRpb25CZWhhdmlvciB7XG4gIHN3aXRjaCAodmFsdWUpIHtcbiAgICBjYXNlIE1hdG9tb0luaXRpYWxpemF0aW9uTW9kZS5BVVRPOlxuICAgICAgcmV0dXJuICdhdXRvJztcbiAgICBjYXNlIE1hdG9tb0luaXRpYWxpemF0aW9uTW9kZS5NQU5VQUw6XG4gICAgICByZXR1cm4gJ21hbnVhbCc7XG4gICAgY2FzZSBNYXRvbW9Jbml0aWFsaXphdGlvbk1vZGUuQVVUT19ERUZFUlJFRDpcbiAgICAgIHJldHVybiAnZGVmZXJyZWQnO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gdmFsdWU7XG4gIH1cbn1cblxuZXhwb3J0IHR5cGUgTWF0b21vQ29uc2VudFJlcXVpcmVtZW50ID0gJ25vbmUnIHwgJ2Nvb2tpZScgfCAndHJhY2tpbmcnO1xuXG4vKiogQGRlcHJlY2F0ZWQgVXNlIHtAbGluayBNYXRvbW9Db25zZW50UmVxdWlyZW1lbnR9IGluc3RlYWQgKi9cbmV4cG9ydCBlbnVtIE1hdG9tb0NvbnNlbnRNb2RlIHtcbiAgLyoqIERvIG5vdCByZXF1aXJlIGFueSBjb25zZW50LCBhbHdheXMgdHJhY2sgdXNlcnMgKi9cbiAgTk9ORSxcbiAgLyoqIFJlcXVpcmUgY29va2llIGNvbnNlbnQgKi9cbiAgQ09PS0lFLFxuICAvKiogUmVxdWlyZSB0cmFja2luZyBjb25zZW50ICovXG4gIFRSQUNLSU5HLFxufVxuXG5leHBvcnQgZnVuY3Rpb24gY29lcmNlQ29uc2VudFJlcXVpcmVtZW50KFxuICB2YWx1ZTogTWF0b21vQ29uc2VudE1vZGUgfCBNYXRvbW9Db25zZW50UmVxdWlyZW1lbnQsXG4pOiBNYXRvbW9Db25zZW50UmVxdWlyZW1lbnQge1xuICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgY2FzZSBNYXRvbW9Db25zZW50TW9kZS5OT05FOlxuICAgICAgcmV0dXJuICdub25lJztcbiAgICBjYXNlIE1hdG9tb0NvbnNlbnRNb2RlLkNPT0tJRTpcbiAgICAgIHJldHVybiAnY29va2llJztcbiAgICBjYXNlIE1hdG9tb0NvbnNlbnRNb2RlLlRSQUNLSU5HOlxuICAgICAgcmV0dXJuICd0cmFja2luZyc7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hdG9tb1RyYWNrZXJDb25maWd1cmF0aW9uIHtcbiAgLyoqIE1hdG9tbyBzaXRlIGlkICovXG4gIHNpdGVJZDogbnVtYmVyIHwgc3RyaW5nO1xuXG4gIC8qKiBNYXRvbW8gc2VydmVyIHVybCAqL1xuICB0cmFja2VyVXJsOiBzdHJpbmc7XG5cbiAgLyoqIFRoZSB0cmFja2VyVXJsU3VmZml4IGlzIGFsd2F5cyBhcHBlbmRlZCB0byB0aGUgdHJhY2tlclVybC4gSXQgZGVmYXVsdHMgdG8gbWF0b21vLnBocCAqL1xuICB0cmFja2VyVXJsU3VmZml4Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE11bHRpVHJhY2tlcnNDb25maWd1cmF0aW9uIHtcbiAgLyoqXG4gICAqIENvbmZpZ3VyZSBtdWx0aXBsZSB0cmFja2luZyBzZXJ2ZXJzLiA8Yj5PcmRlciBtYXR0ZXJzOiBpZiBubyBjdXN0b20gc2NyaXB0IHVybCBpc1xuICAgKiBwcm92aWRlZCwgTWF0b21vIHNjcmlwdCB3aWxsIGJlIGRvd25sb2FkZWQgZnJvbSBmaXJzdCB0cmFja2VyLjwvYj5cbiAgICovXG4gIHRyYWNrZXJzOiBNYXRvbW9UcmFja2VyQ29uZmlndXJhdGlvbltdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJhc2VNYXRvbW9Db25maWd1cmF0aW9uIHtcbiAgLyoqIFNldCB0byBgdHJ1ZWAgdG8gZGlzYWJsZSB0cmFja2luZyAqL1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG5cbiAgLyoqIElmIGB0cnVlYCwgdHJhY2sgYSBwYWdlIHZpZXcgd2hlbiBhcHAgbG9hZHMgKGRlZmF1bHQgYGZhbHNlYCkgKi9cbiAgdHJhY2tBcHBJbml0aWFsTG9hZD86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIENvbmZpZ3VyZSBsaW5rIGNsaWNrcyB0cmFja2luZ1xuICAgKlxuICAgKiBJZiBgdHJ1ZWAgKHRoZSBkZWZhdWx0IHZhbHVlKSwgZW5hYmxlIGxpbmsgdHJhY2tpbmcsIGV4Y2x1ZGluZyBtaWRkbGUtY2xpY2tzIGFuZCBjb250ZXh0bWVudSBldmVudHMuXG4gICAqIElmIGBlbmFibGUtcHNldWRvYCwgZW5hYmxlIGxpbmsgdHJhY2tpbmcsIGluY2x1ZGluZyBtaWRkbGUtY2xpY2tzIGFuZCBjb250ZXh0bWVudSBldmVudHMuXG4gICAqIElmIGBmYWxzZWAsIHRvIGRpc2FibGUgdGhpcyBNYXRvbW8gZmVhdHVyZSAoZGVmYXVsdCBgdHJ1ZWApLlxuICAgKlxuICAgKiBVc2VkIHdoZW4ge0BsaW5rIHRyYWNrQXBwSW5pdGlhbExvYWR9IGlzIGB0cnVlYCBhbmQgd2hlbiBhdXRvbWF0aWMgcGFnZSB0cmFja2luZyBpcyBlbmFibGVkLlxuICAgKlxuICAgKiBAc2VlIHtAbGluayBNYXRvbW9UcmFja2VyLmVuYWJsZUxpbmtUcmFja2luZ30gZm9yIG1vcmUgZGV0YWlsc1xuICAgKi9cbiAgZW5hYmxlTGlua1RyYWNraW5nPzogYm9vbGVhbiB8ICdlbmFibGUtcHNldWRvJztcblxuICAvKiogU2V0IHRvIGB0cnVlYCB0byBub3QgdHJhY2sgdXNlcnMgd2hvIG9wdCBvdXQgb2YgdHJhY2tpbmcgdXNpbmcgPGk+RG8gTm90IFRyYWNrPC9pPiBzZXR0aW5nICovXG4gIGFjY2VwdERvTm90VHJhY2s/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBDb25maWd1cmUgdXNlciBjb25zZW50IHJlcXVpcmVtZW50XG4gICAqXG4gICAqIFRvIGlkZW50aWZ5IHdoZXRoZXIgeW91IG5lZWQgdG8gYXNrIGZvciBhbnkgY29uc2VudCwgeW91IG5lZWQgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgeW91ciBsYXdmdWxcbiAgICogYmFzaXMgZm9yIHByb2Nlc3NpbmcgcGVyc29uYWwgZGF0YSBpcyBcIkNvbnNlbnRcIiBvciBcIkxlZ2l0aW1hdGUgaW50ZXJlc3RcIiwgb3Igd2hldGhlciB5b3UgY2FuXG4gICAqIGF2b2lkIGNvbGxlY3RpbmcgcGVyc29uYWwgZGF0YSBhbHRvZ2V0aGVyLlxuICAgKlxuICAgKiBNYXRvbW8gZGlmZmVyZW50aWF0ZXMgYmV0d2VlbiBjb29raWUgYW5kIHRyYWNraW5nIGNvbnNlbnQ6XG4gICAqIC0gSW4gdGhlIGNvbnRleHQgb2YgPGI+dHJhY2tpbmcgY29uc2VudDwvYj4gbm8gY29va2llcyB3aWxsIGJlIHVzZWQgYW5kIG5vIHRyYWNraW5nIHJlcXVlc3RcbiAgICogICB3aWxsIGJlIHNlbnQgdW5sZXNzIGNvbnNlbnQgd2FzIGdpdmVuLiBBcyBzb29uIGFzIGNvbnNlbnQgd2FzIGdpdmVuLCB0cmFja2luZyByZXF1ZXN0cyB3aWxsXG4gICAqICAgYmUgc2VudCBhbmQgY29va2llcyB3aWxsIGJlIHVzZWQuXG4gICAqIC0gSW4gdGhlIGNvbnRleHQgb2YgPGI+Y29va2llIGNvbnNlbnQ8L2I+IHRyYWNraW5nIHJlcXVlc3RzIHdpbGwgYWx3YXlzIGJlIHNlbnQuIEhvd2V2ZXIsXG4gICAqICAgY29va2llcyB3aWxsIGJlIG9ubHkgdXNlZCBpZiBjb25zZW50IGZvciBzdG9yaW5nIGFuZCB1c2luZyBjb29raWVzIHdhcyBnaXZlbiBieSB0aGUgdXNlci5cbiAgICpcbiAgICogTm90ZSB0aGF0IGNvb2tpZXMgaW1wYWN0IHJlcG9ydHMgYWNjdXJhY3kuXG4gICAqXG4gICAqIFNlZSBNYXRvbW8gZ3VpZGU6IHtAbGluayBodHRwczovL2RldmVsb3Blci5tYXRvbW8ub3JnL2d1aWRlcy90cmFja2luZy1jb25zZW50fVxuICAgKi9cbiAgcmVxdWlyZUNvbnNlbnQ/OiBNYXRvbW9Db25zZW50UmVxdWlyZW1lbnQgfCBNYXRvbW9Db25zZW50TW9kZTtcblxuICAvKiogU2V0IHRvIGB0cnVlYCB0byBlbmFibGUgSmF2YXNjcmlwdCBlcnJvcnMgdHJhY2tpbmcgYXMgPGk+ZXZlbnRzPC9pPiAod2l0aCBjYXRlZ29yeSA8aT5KYXZhU2NyaXB0IEVycm9yczwvaT4pICovXG4gIGVuYWJsZUpTRXJyb3JUcmFja2luZz86IGJvb2xlYW47XG5cbiAgLyoqIFNldCB0byBgdHJ1ZWAgdG8gcnVuIG1hdG9tbyBjYWxscyBvdXRzaWRlIG9mIGFuZ3VsYXIgTmdab25lLiBUaGlzIG1heSBmaXggYW5ndWxhciBmcmVlemVzLiAqL1xuICBydW5PdXRzaWRlQW5ndWxhclpvbmU/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBTZXQgdG8gYHRydWVgIHRvIGF2b2lkIHNlbmRpbmcgY2FtcGFpZ24gcGFyYW1ldGVyc1xuICAgKlxuICAgKiBCeSBkZWZhdWx0LCBNYXRvbW8gd2lsbCBzZW5kIGNhbXBhaWduIHBhcmFtZXRlcnMgKG10bSwgdXRtLCBldGMuKSB0byB0aGUgdHJhY2tlciBhbmQgcmVjb3JkIHRoYXQgaW5mb3JtYXRpb24uXG4gICAqIFNvbWUgcHJpdmFjeSByZWd1bGF0aW9ucyBtYXkgbm90IGFsbG93IGZvciB0aGlzIGluZm9ybWF0aW9uIHRvIGJlIGNvbGxlY3RlZC5cbiAgICpcbiAgICogPGI+VGhpcyBpcyBhdmFpbGFibGUgYXMgb2YgTWF0b21vIDUuMSBvbmx5LjwvYj5cbiAgICovXG4gIGRpc2FibGVDYW1wYWlnblBhcmFtZXRlcnM/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIE1hcHBpbmcgdHlwZSB0byBleHRlbmQgaW5wdXQgdHlwZXMgd2l0aCBsZWdhY3kgYE1hdG9tb0luaXRpYWxpemF0aW9uTW9kZWAgdHlwZVxuICpcbiAqIFRPRE8gcmVtb3ZlIHdoZW4gYE1hdG9tb0luaXRpYWxpemF0aW9uTW9kZWAgaXMgcmVtb3ZlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIE1hdG9tb0luaXRpYWxpemF0aW9uQmVoYXZpb3JJbnB1dE1hcHBpbmcge1xuICBtYW51YWw6IE1hdG9tb0luaXRpYWxpemF0aW9uTW9kZS5NQU5VQUw7XG4gIGF1dG86IE1hdG9tb0luaXRpYWxpemF0aW9uTW9kZS5BVVRPO1xuICBkZWZlcnJlZDogTWF0b21vSW5pdGlhbGl6YXRpb25Nb2RlLkFVVE9fREVGRVJSRUQ7XG59XG5cbi8qKlxuICogU3BlY2lhbCB0eXBlIHRvIG1hcCBhIGBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9yYCB0byBlaXRoZXIgaXRzZWxmIG9yIHRoZSBsZWdhY3kgZXF1aXZhbGVudCBgTWF0b21vSW5pdGlhbGl6YXRpb25Nb2RlYFxuICpcbiAqIEBleGFtcGxlXG4gKiBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9ySW5wdXQ8J2F1dG8nPlxuICogICAvLyBFcXVpdmFsZW50IHRvOlxuICogJ2F1dG8nIHwgTWF0b21vSW5pdGlhbGl6YXRpb25Nb2RlLkFVVE9cbiAqXG4gKiBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9ySW5wdXQ8J21hbnVhbCc+XG4gKiAgIC8vIEVxdWl2YWxlbnQgdG86XG4gKiAnbWFudWFsJyB8IE1hdG9tb0luaXRpYWxpemF0aW9uTW9kZS5NQU5VQUxcbiAqXG4gKiBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9ySW5wdXQ8J2RlZmVycmVkJz5cbiAqICAgLy8gRXF1aXZhbGVudCB0bzpcbiAqICdkZWZlcnJlZCcgfCBNYXRvbW9Jbml0aWFsaXphdGlvbk1vZGUuQVVUT19ERUZFUlJFRFxuICpcbiAqIFRPRE8gcmVtb3ZlIHdoZW4gYE1hdG9tb0luaXRpYWxpemF0aW9uTW9kZWAgaXMgcmVtb3ZlZCBhbmQgdXNlIGBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9yYCBpbnN0ZWFkXG4gKi9cbmV4cG9ydCB0eXBlIE1hdG9tb0luaXRpYWxpemF0aW9uQmVoYXZpb3JJbnB1dDxcbiAgVCBleHRlbmRzIE1hdG9tb0luaXRpYWxpemF0aW9uQmVoYXZpb3IgPSBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9yLFxuPiA9IFQgfCBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9ySW5wdXRNYXBwaW5nW1RdO1xuXG5leHBvcnQgaW50ZXJmYWNlIEJhc2VBdXRvTWF0b21vQ29uZmlndXJhdGlvbjxNIGV4dGVuZHMgJ2F1dG8nIHwgJ2RlZmVycmVkJyA9ICdhdXRvJz4ge1xuICAvKipcbiAgICogU2V0IHRoZSBzY3JpcHQgaW5pdGlhbGl6YXRpb24gbW9kZSAoZGVmYXVsdCBpcyBgJ2F1dG8nYClcbiAgICpcbiAgICogQHNlZSBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9yXG4gICAqL1xuICBtb2RlPzogTWF0b21vSW5pdGlhbGl6YXRpb25CZWhhdmlvcklucHV0PE0+O1xuXG4gIC8qKiBNYXRvbW8gc2NyaXB0IHVybCAoZGVmYXVsdCBpcyBgbWF0b21vLmpzYCBhcHBlbmRlZCB0byBtYWluIHRyYWNrZXIgdXJsKSAqL1xuICBzY3JpcHRVcmw6IHN0cmluZztcbn1cblxudHlwZSBXaXRob3V0PFQsIFU+ID0geyBbUCBpbiBFeGNsdWRlPGtleW9mIFQsIGtleW9mIFU+XT86IG5ldmVyIH07XG50eXBlIFhPUjxULCBVPiA9IFQgfCBVIGV4dGVuZHMgb2JqZWN0ID8gKFdpdGhvdXQ8VCwgVT4gJiBVKSB8IChXaXRob3V0PFUsIFQ+ICYgVCkgOiBUIHwgVTtcbnR5cGUgWE9SMzxULCBVLCBWPiA9IFhPUjxULCBYT1I8VSwgVj4+O1xuXG5leHBvcnQgdHlwZSBNYW51YWxNYXRvbW9Db25maWd1cmF0aW9uID0ge1xuICAvKipcbiAgICogU2V0IHRoZSBzY3JpcHQgaW5pdGlhbGl6YXRpb24gbW9kZSAoZGVmYXVsdCBpcyBgJ2F1dG8nYClcbiAgICpcbiAgICogQHNlZSBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9yXG4gICAqL1xuICBtb2RlOiBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9ySW5wdXQ8J21hbnVhbCc+O1xufTtcblxuZXhwb3J0IHR5cGUgRGVmZXJyZWRNYXRvbW9Db25maWd1cmF0aW9uID0ge1xuICAvKipcbiAgICogU2V0IHRoZSBzY3JpcHQgaW5pdGlhbGl6YXRpb24gbW9kZSAoZGVmYXVsdCBpcyBgJ2F1dG8nYClcbiAgICpcbiAgICogQHNlZSBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9yXG4gICAqL1xuICBtb2RlOiBNYXRvbW9Jbml0aWFsaXphdGlvbkJlaGF2aW9ySW5wdXQ8J2RlZmVycmVkJz47XG59O1xuXG5leHBvcnQgdHlwZSBFeHBsaWNpdEF1dG9Db25maWd1cmF0aW9uPE0gZXh0ZW5kcyAnYXV0bycgfCAnZGVmZXJyZWQnID0gJ2F1dG8nPiA9IFBhcnRpYWw8XG4gIEJhc2VBdXRvTWF0b21vQ29uZmlndXJhdGlvbjxNPlxuPiAmXG4gIFhPUjxNYXRvbW9UcmFja2VyQ29uZmlndXJhdGlvbiwgTXVsdGlUcmFja2Vyc0NvbmZpZ3VyYXRpb24+O1xuXG5leHBvcnQgdHlwZSBFbWJlZGRlZEF1dG9Db25maWd1cmF0aW9uPE0gZXh0ZW5kcyAnYXV0bycgfCAnZGVmZXJyZWQnID0gJ2F1dG8nPiA9XG4gIEJhc2VBdXRvTWF0b21vQ29uZmlndXJhdGlvbjxNPiAmIFBhcnRpYWw8TXVsdGlUcmFja2Vyc0NvbmZpZ3VyYXRpb24+O1xuXG5leHBvcnQgdHlwZSBBdXRvTWF0b21vQ29uZmlndXJhdGlvbjxNIGV4dGVuZHMgJ2F1dG8nIHwgJ2RlZmVycmVkJyA9ICdhdXRvJz4gPSBYT1I8XG4gIEV4cGxpY2l0QXV0b0NvbmZpZ3VyYXRpb248TT4sXG4gIEVtYmVkZGVkQXV0b0NvbmZpZ3VyYXRpb248TT5cbj47XG5cbmV4cG9ydCB0eXBlIE1hdG9tb0NvbmZpZ3VyYXRpb24gPSBCYXNlTWF0b21vQ29uZmlndXJhdGlvbiAmXG4gIFhPUjM8QXV0b01hdG9tb0NvbmZpZ3VyYXRpb24sIE1hbnVhbE1hdG9tb0NvbmZpZ3VyYXRpb24sIERlZmVycmVkTWF0b21vQ29uZmlndXJhdGlvbj47XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0F1dG9Db25maWd1cmF0aW9uTW9kZShcbiAgY29uZmlnOiBNYXRvbW9Db25maWd1cmF0aW9uIHwgSW50ZXJuYWxNYXRvbW9Db25maWd1cmF0aW9uLFxuKTogY29uZmlnIGlzIEF1dG9NYXRvbW9Db25maWd1cmF0aW9uIHtcbiAgcmV0dXJuIChcbiAgICBjb25maWcubW9kZSA9PSBudWxsIHx8IGNvbmZpZy5tb2RlID09PSAnYXV0bycgfHwgY29uZmlnLm1vZGUgPT09IE1hdG9tb0luaXRpYWxpemF0aW9uTW9kZS5BVVRPXG4gICk7XG59XG5cbmZ1bmN0aW9uIGhhc01haW5UcmFja2VyQ29uZmlndXJhdGlvbjxNIGV4dGVuZHMgJ2F1dG8nIHwgJ2RlZmVycmVkJz4oXG4gIGNvbmZpZzogQXV0b01hdG9tb0NvbmZpZ3VyYXRpb248TT4sXG4pOiBjb25maWcgaXMgRXhwbGljaXRBdXRvQ29uZmlndXJhdGlvbjxNPiB7XG4gIC8vIElmIG9uZSBpcyB1bmRlZmluZWQsIGJvdGggc2hvdWxkIGJlXG4gIHJldHVybiBjb25maWcuc2l0ZUlkICE9IG51bGwgJiYgY29uZmlnLnRyYWNrZXJVcmwgIT0gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRW1iZWRkZWRUcmFja2VyQ29uZmlndXJhdGlvbjxNIGV4dGVuZHMgJ2F1dG8nIHwgJ2RlZmVycmVkJz4oXG4gIGNvbmZpZzogQXV0b01hdG9tb0NvbmZpZ3VyYXRpb248TT4sXG4pOiBjb25maWcgaXMgRW1iZWRkZWRBdXRvQ29uZmlndXJhdGlvbjxNPiB7XG4gIHJldHVybiBjb25maWcuc2NyaXB0VXJsICE9IG51bGwgJiYgIWhhc01haW5UcmFja2VyQ29uZmlndXJhdGlvbihjb25maWcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNFeHBsaWNpdFRyYWNrZXJDb25maWd1cmF0aW9uPE0gZXh0ZW5kcyAnYXV0bycgfCAnZGVmZXJyZWQnPihcbiAgY29uZmlnOiBBdXRvTWF0b21vQ29uZmlndXJhdGlvbjxNPixcbik6IGNvbmZpZyBpcyBFeHBsaWNpdEF1dG9Db25maWd1cmF0aW9uPE0+IHtcbiAgcmV0dXJuIGhhc01haW5UcmFja2VyQ29uZmlndXJhdGlvbihjb25maWcpIHx8IGlzTXVsdGlUcmFja2VyQ29uZmlndXJhdGlvbihjb25maWcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNNdWx0aVRyYWNrZXJDb25maWd1cmF0aW9uKFxuICBjb25maWc6IEF1dG9NYXRvbW9Db25maWd1cmF0aW9uPCdhdXRvJyB8ICdkZWZlcnJlZCc+LFxuKTogY29uZmlnIGlzIE11bHRpVHJhY2tlcnNDb25maWd1cmF0aW9uIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoY29uZmlnLnRyYWNrZXJzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRyYWNrZXJzQ29uZmlndXJhdGlvbihcbiAgY29uZmlnOiBFeHBsaWNpdEF1dG9Db25maWd1cmF0aW9uPCdhdXRvJyB8ICdkZWZlcnJlZCc+LFxuKTogTWF0b21vVHJhY2tlckNvbmZpZ3VyYXRpb25bXSB7XG4gIHJldHVybiBpc011bHRpVHJhY2tlckNvbmZpZ3VyYXRpb24oY29uZmlnKVxuICAgID8gY29uZmlnLnRyYWNrZXJzXG4gICAgOiBbXG4gICAgICAgIHtcbiAgICAgICAgICB0cmFja2VyVXJsOiBjb25maWcudHJhY2tlclVybCxcbiAgICAgICAgICBzaXRlSWQ6IGNvbmZpZy5zaXRlSWQsXG4gICAgICAgICAgdHJhY2tlclVybFN1ZmZpeDogY29uZmlnLnRyYWNrZXJVcmxTdWZmaXgsXG4gICAgICAgIH0sXG4gICAgICBdO1xufVxuIl19